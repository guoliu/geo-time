<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>

  <div id="graph1'"></div>

  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://d3js.org/queue.v1.js"></script>
  <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
  <script src="line-graph.js"></script>
  <script>


    /* 
     * If running inside bl.ocks.org we want to resize the iframe to fit both graphs
     */
     if(parent.document.getElementsByTagName("iframe")[0]) {
       parent.document.getElementsByTagName("iframe")[0].setAttribute('style', 'height: 650px !important');
     }

     /*
     * Note how the 'data' object is added to here before rendering to provide decoration information.
     * <p>
     * This is purposefully done here instead of in data.js as an example of how data would come from a server
     * and then have presentation information injected into it (rather than as separate arguments in another object)
     * and passed into LineGraph.
     *
     * Also, CSS can be used to style colors etc, but this is also doable via the 'data' object so that the styling
     * of different data points can be done in code which is often more natural for display names, legends, line colors etc
     */
     // add presentation logic for 'data' object using optional data arguments
     var data = {}
     data["displayNames"] = ["2xx","3xx","4xx","5xx"];
     data["colors"] = ["green","orange","red","darkred"];
     data["scale"] = "pow";

     data["values"] = [1,2,3,4];
     data["start"] = 10000;
     data["end"] = 13000;
     data["step"] = 1000;
     data["names"] = ["test"] 

     // create graph now that we've added presentation config
     var l1 = new LineGraph({containerId: 'graph1', data: data});


     setInterval(function() {
    /*
    * The following will simulate live updating of the data (see dataA, dataB, dataC etc in data.js which are real examples)
    * This is being simulated so this example functions standalone without a backend server which generates data such as data.js contains.
    */
    // for each data series ...
    var newData = [];
    data.values.forEach(function(dataSeries, index) {
      // take the first value and move it to the end
      // and capture the value we're moving so we can send it to the graph as an update
      var v = dataSeries.shift();
      dataSeries.push(v);
      // put this value in newData as an array with 1 value
      newData[index] = [v];
    })
    
    // we will reuse dataA each time
    dataA.values = newData;
    // increment time 1 step
    dataA.start = dataA.start + dataA.step;
    dataA.end = dataA.end + dataA.step; 
    console.log(dataA);
    l1.slideData(dataA);
  }, 2000);
     </script>
   </body>
   </html>